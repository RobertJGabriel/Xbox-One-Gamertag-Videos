function makeXboxCall(e,t,i,a){myBtn.innerHTML="loading ......",$.ajax({url:"https://account.xbox.com/en-us/"+getType+"/loadByUser?gamerTag="+gamerTagValadator(i)+"&ContinuationToken="+token,type:"GET",dataType:"json",success:function(t){token="undefined"!==t.ContinuationToken?t.ContinuationToken:"","gameclips"===getType?getGameclips(t,e,a):getScreenshots(t,e,a),(void 0===token||null===token)&&(myBtn.innerHTML="All Media Loaded")}})}function getGameclips(e,t,i){i=0===i?e.GameClips.length:i;var a;for(a=0;i>a;a++)title.push(e.GameClips[a].TitleName),uploadTime.push(e.GameClips[a].UploadTime),mediaSrc.push(e.GameClips[a].ClipUri),screenPreview.push(e.GameClips[a].Thumbnail);renderMedia(t,i)}function getScreenshots(e,t,i){i=0===i?e.data.Screenshots.length:i;var a;for(a=0;i>a;a++)title.push(e.data.Screenshots[a].TitleName),uploadTime.push(e.data.Screenshots[a].CaptureTime),mediaSrc.push(e.data.Screenshots[a].Uri),screenPreview.push(e.data.Screenshots[a].Thumbnail);renderMedia(t,i)}function gamerTagValadator(e){var t=encodeURIComponent(e.trim());return t}function createImage(e,t,i,a){var n=document.createElement("img");n.setAttribute("src",t),n.setAttribute("width",mediaWidth),n.setAttribute("height",mediaHeight),n.setAttribute("class","img-responsive ");var r=document.createElement("A");r.setAttribute("href",e),r.setAttribute("class","thumbnail"),r.appendChild(n),xboxDiv.appendChild(createPanel(r,i,a))}function createVideo(e,t,i,a){var n=document.createElement("VIDEO");n.canPlayType("video/mp4")===!0?n.setAttribute("src",e):n.setAttribute("src",e),n.setAttribute("preload","none"),n.setAttribute("width",mediaWidth),n.setAttribute("poster",t),n.setAttribute("height",mediaHeight),n.setAttribute("class","img-responsive "),n.setAttribute("controls","controls"),xboxDiv.appendChild(createPanel(n,i,a))}function createPanel(e,t,i){var a=document.createElement("div");a.setAttribute("class","panel panel-primary");var n=document.createElement("div");n.setAttribute("class","panel-heading");var r=document.createElement("h3");r.setAttribute("class","panel-title");var d=document.createTextNode(t+"  "+i);r.appendChild(d),n.appendChild(r);var o=document.createElement("div");return o.setAttribute("class","panel-body"),o.appendChild(e),a.appendChild(n),a.appendChild(o),a}function renderMedia(e,t){var i,a=Math.floor(Math.random()*mediaSrc.length)+0;if(1===e)for(i=0;i<mediaSrc.length;i++)"gameclips"===getType?createVideo(mediaSrc[i],screenPreview[i],title[i],uploadTime[i]):createImage(mediaSrc[i],screenPreview[i],title[i],uploadTime[i]);else"gameclips"===getType?createVideo(mediaSrc[a],screenPreview[a],title[a],uploadTime[a]):createImage(mediaSrc[a],screenPreview[a],title[a],uploadTime[a]);myBtn.innerHTML="Load More"}var title=[],uploadTime=[],mediaSrc=[],screenPreview=[],limits=0,mediaWidth,mediaHeight=0,getType=null,token="",myBtn=document.getElementById("buttonSearch"),xboxDiv=document.getElementById("xboxOneMedia"),xboxOneMedia={Init:function(e,t,i,a,n,r){getType!==t?screenPreview=[]:0,getType!==t?mediaSrc=[]:0,xboxDiv.innerHTML="",mediaWidth=a,mediaHeight=n,getType=t,limits="undefined"!=typeof r?r:0,"undefined"==typeof token?token="":0,makeXboxCall(e,t,i,limits)}};
